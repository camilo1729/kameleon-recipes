## This is a recipe test for Arch Linux"
global:
  workdir_base: /tmp/kameleon/
  distrib: archlinux
  arch: x86_64
  key_ring_activated: "false"
  ### Care must be take in choosing a mirror because of the cache, it might not work
  #distrib_repository: "ftp://ftp.hosteurope.de/mirror/ftp.archlinux.org"
  #distrib_repository: "ftp://mirrors.kernel.org/archlinux/"
#  distrib_repository: "http://www.laqee.unal.edu.co/archlinux/" cache generated
#  distrib_repository: "http://mirrors.xmission.com/archlinux/" #cache generated
  distrib_repository: "http://mirrors.st.uz/archlinux/" #cache generated
#  distrib_repository: "http://mirrors.mithril.org.ua/linux/archlinux/" cache generated
#  distrib_repository: "http://archlinux.cs.nctu.edu.tw/"
  output_environment_file_system_type: "ext3"
steps:
  - bootstrap
  - mount_proc
  - mount_sys
  - mount_dev
  - pacman:
      - key_ring_config
      - install_linux
     # - initial_pacman
      - install_base
  - umount_proc
  #- umount_sys
  - build_appliance_kpartx:
      - clean_udev
      - create_raw_image
      - attach_kpartx_device
      - mkfs
      - mount_image
      - copy_system_tree
      - get_kernel_initrd_arch
      - install_extlinux
      - umount_image
      - save_as_raw
      - save_as_vdi
  - clean 