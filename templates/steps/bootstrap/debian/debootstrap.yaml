# # Bootstrap
- enable_cache: true

- debootstrap:
  - check_cmd_out: debootstrap
  - exec_out: mkdir -p $$rootfs_cache
  - exec_out: |
        if [ $$enable_cache = true ]; then
            [[ ! -f "$$rootfs_cache/.kameleon_timestamp"  ]] || CACHE_AVAILABLE=1
        fi
        [[ -n $CACHE_AVAILABLE  ]] || debootstrap --no-check-gpg --arch=$$arch --include="$$include" $$release $$rootfs_cache $$repository
        [[ -n $CACHE_AVAILABLE  ]] || date +%s > $$rootfs_cache/.kameleon_timestamp
  - exec_out: cat /etc/resolv.conf > $$rootfs_cache/etc/resolv.conf
  - write_out:
    - $$rootfs_cache/etc/network/interfaces
    - |
      auto lo
      iface lo inet loopback
      auto eth0
      iface eth0 inet dhcp

